(function(t){function e(e){for(var i,o,s=e[0],l=e[1],c=e[2],d=0,m=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&m.push(r[o][0]),r[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);u&&u(e);while(m.length)m.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,s=1;s<n.length;s++){var l=n[s];0!==r[l]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},r={app:0},a=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/TL-Editor/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"023e":function(t,e,n){},"2f8c":function(t,e,n){"use strict";n("52ff")},"52ff":function(t,e,n){},"561d":function(t,e,n){"use strict";n("023e")},"56d7":function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"isValidTimestamp",(function(){return C})),n.d(i,"binarySearch",(function(){return _})),n.d(i,"convertToClockTime",(function(){return S})),n.d(i,"setCurrentTime",(function(){return P})),n.d(i,"sortTLs",(function(){return E})),n.d(i,"default",(function(){return A}));n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},o=[],s=(n("561d"),n("2877")),l={},c=Object(s["a"])(l,a,o,!1,null,null,null),u=c.exports,d=n("f309");r["a"].use(d["a"]);var m=new d["a"]({}),f=n("8c4f"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app",{attrs:{dark:""}},[n("BottomBar",{on:{addTL:function(e){return t.addTL()}}}),n("v-main",{staticStyle:{"max-height":"100%"}},[n("div",{staticClass:"horizontal-split"},[n("div",{staticClass:"left-panel",style:"width: calc(100% * (1 - "+t.videoWidth+"));"},[n("v-list",{attrs:{dark:""}},[t.tls.length?t._e():n("v-list-item",{staticClass:"tl-entry"},[n("v-list-item-content",[t._v(" No caption entries to display ")])],1),t._l(t.sortedTLs,(function(e){return n("div",{key:e?e.id:"",staticClass:"tl-entry splash"},[n("TL",{attrs:{tl:e},on:{editTL:t.editTL,tlTimeChanged:t.tlTimeChanged,removeTL:t.removeTL,stopEditing:t.stopEditing}})],1)}))],2)],1),n("div",{style:"height: 100%; width: calc(100% * "+t.videoWidth+")"},[n("Video")],1)])]),t.repositioning?n("div",{staticClass:"overlay"}):t._e(),t._l(t.tls,(function(e){return n("div",{key:e.id},[n("div",{staticClass:"tl-marker",style:{left:t.calcLeft(e)},on:{click:function(n){return t.editTL(e)},mousedown:function(n){return t.dragStarted(n,e)}}})])}))],2)},v=[],h=n("1da1"),T=n("5530"),g=(n("d3b7"),n("d81d"),n("96cf"),function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),y=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"wrapper"}},[n("div",{attrs:{id:"player"}})])}],b=n("2f62"),x=n("43cf"),w=n.n(x),L={name:"Video",computed:Object(b["b"])(["player","videoID"]),watch:{videoID:function(){this.player.loadVideoById(this.videoID)}},mounted:function(){var t=this;w.a.load((function(e){t.$store.commit("setPlayer",new e.Player("player",{height:"100%",width:"100%",videoId:t.videoID,autoplay:1,playerVars:{autoplay:1}}))}))},methods:{},props:{}},O=L,k=(n("94f2"),Object(s["a"])(O,g,y,!1,null,"f038c382",null)),$=k.exports,I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-app-bar",{attrs:{app:"",bottom:"",dense:"",color:"primary"}},[n("div",{staticClass:"wrapper"},[n("div",{staticStyle:{"margin-right":"auto"}},[n("v-btn",{staticStyle:{float:"left",position:"relative",margin:"20px",width:"min-content"},on:{click:function(e){return t.$emit("addTL")}}},[n("v-icon",[t._v(" mdi-plus ")]),t._v(" New Caption ")],1)],1),n("div",[n("v-text-field",{staticStyle:{width:"8em !important"},attrs:{label:"Video",filled:"",dark:"",outlined:""},model:{value:t.videoID,callback:function(e){t.videoID=e},expression:"videoID"}}),n("v-text-field",{attrs:{label:"Hour",filled:"",dark:"",rules:[t.isValidTimestamp],outlined:""},on:{change:function(e){return t.currentTimeChanged()},focus:function(e){return t.player.pauseVideo()}},model:{value:t.timestamp[0],callback:function(e){t.$set(t.timestamp,0,e)},expression:"timestamp[0]"}}),n("v-text-field",{attrs:{label:"Minute",filled:"",dark:"",rules:[t.isValidTimestamp],outlined:""},on:{change:function(e){return t.currentTimeChanged()},focus:function(e){return t.player.pauseVideo()}},model:{value:t.timestamp[1],callback:function(e){t.$set(t.timestamp,1,e)},expression:"timestamp[1]"}}),n("v-text-field",{attrs:{label:"Second",filled:"",dark:"",rules:[t.isValidTimestamp],outlined:""},on:{change:function(e){return t.currentTimeChanged()},focus:function(e){return t.player.pauseVideo()}},model:{value:t.timestamp[2],callback:function(e){t.$set(t.timestamp,2,e)},expression:"timestamp[2]"}}),n("v-btn",{staticClass:"mx-2",attrs:{id:"play",fab:"",dark:"",small:"",color:"cyan"},on:{click:function(e){return t.togglePlay()}}},[1==t.getPlayerState()?n("v-icon",{attrs:{dark:""}},[t._v(" mdi-pause ")]):n("v-icon",{attrs:{dark:""}},[t._v(" mdi-play ")])],1)],1),n("div")])])},V=[],j=n("2909");n("ac1f"),n("1276"),n("159b"),n("b64b"),n("a434");r["a"].use(b["a"]);var D=new b["a"].Store({state:{player:null,videoID:"Z-a58aBXH58",tls:[],sortedTLs:[],currentTime:0,videoDuration:1},mutations:{setCurrentTime:function(t,e){P(t,e)},setTimestamp:function(t,e){var n=e.map((function(t){return parseInt(t)}));P(t,60*(60*n[0]+n[1])+n[2])},setPlayer:function(t,e){t.player=e},pushTL:function(t,e){t.tls.push(e)},addAttrTL:function(t,e){var n=e.index,i=e.data;Object.keys(i).forEach((function(e){t.tls[n][e]=i[e]}))},removeTL:function(t,e){t.tls.splice(e,1);for(var n=e;n<t.tls.length;n++)t.tls[n].index=n},setVideoID:function(t,e){t.videoID=e},setDuration:function(t,e){t.videoDuration=e}},getters:{timestamp:function(t){return S(t.currentTime)},sortedTLs:function(t){return Object(j["a"])(t.tls).sort((function(t,e){return t.startTimeOffset!==e.startTimeOffset?t.startTimeOffset-e.startTimeOffset:t.index-e.index}))}}});function C(t){return t>=0&&t<=60}function _(t){var e=0,n=D.getters.sortedTLs.length;while(e<n){var i=Math.floor((e+n)/2);t<=D.getters.sortedTLs[i].startTimeOffset?n=i:e=i+1}return e<D.getters.sortedTLs.length&&D.getters.sortedTLs[e]<t&&e++,e}function S(t){return new Date(1e3*parseFloat(t)).toISOString().substr(11,8).split(":").map((function(t){return parseInt(t)}))}function P(t,e){var n=S(e);Math.abs(e-t.currentTime)>=.5&&n[1]<=60&&n[2]<=60&&t.player.seekTo(60*(60*n[0]+n[1])+n[2]),t.currentTime=e}function E(t){t.sortedTLs=Object(j["a"])(t.tls).sort((function(t,e){return t.startTimeOffset!==e.startTimeOffset?t.startTimeOffset-e.startTimeOffset:t.index-e.index}))}var B={};for(var M in i)"default"!==M&&(B[M]=i[M]);var A=B,R={name:"BottomBar",computed:Object(T["a"])(Object(T["a"])({},Object(b["b"])(["player","timestamp"])),{},{videoID:{set:function(t){this.$store.commit("setVideoID",t)},get:function(){return this.$store.state.videoID}},timestamp:{set:function(t){this.$store.commit("setTimestamp",t)},get:function(){return this.$store.getters.timestamp}}}),watch:{},mounted:function(){},methods:Object(T["a"])(Object(T["a"])({},A),{},{getPlayerState:function(){return this.$store.state.player&&this.$store.state.player.getPlayerState?this.$store.state.player.getPlayerState():-1},currentTimeChanged:function(){this.timestamp=this.timestamp},togglePlay:function(){1===this.$store.state.player.getPlayerState()?this.player.pauseVideo():this.player.playVideo()}})},W=R,H=n("6544"),q=n.n(H),F=n("40dc"),J=n("8336"),N=n("132d"),U=n("8654"),X=Object(s["a"])(W,I,V,!1,null,null,null),z=X.exports;q()(X,{VAppBar:F["a"],VBtn:J["a"],VIcon:N["a"],VTextField:U["a"]});var Z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-list-item",{attrs:{id:"tl"+t.tl.index}},[n("v-list-item-content",[n("v-textarea",{attrs:{dark:"",filled:"",name:"input-7-4",label:"Caption text",value:t.tl.translatedText,focused:""},on:{focus:function(e){return t.$emit("editTL",t.tl)}},model:{value:t.tl.translatedText,callback:function(e){t.$set(t.tl,"translatedText",e)},expression:"tl.translatedText"}})],1),n("v-list-item-action",{staticStyle:{display:"flex","align-items":"center","justify-content":"flex-end"}},[n("v-text-field",{staticClass:"tl-time-indicator",attrs:{label:"Hour",filled:"",dark:"",rules:[t.isValidTimestamp],outlined:""},on:{change:function(e){return t.$emit("tlTimeChanged",t.tl)}},model:{value:t.tl.timestamp[0],callback:function(e){t.$set(t.tl.timestamp,0,e)},expression:"tl.timestamp[0]"}}),n("v-text-field",{staticClass:"tl-time-indicator",attrs:{label:"Minute",filled:"",dark:"",rules:[t.isValidTimestamp],outlined:""},on:{change:function(e){return t.$emit("tlTimeChanged",t.tl)}},model:{value:t.tl.timestamp[1],callback:function(e){t.$set(t.tl.timestamp,1,e)},expression:"tl.timestamp[1]"}}),n("v-text-field",{staticClass:"tl-time-indicator",attrs:{label:"Second",filled:"",dark:"",rules:[t.isValidTimestamp],outlined:""},on:{change:function(e){return t.$emit("tlTimeChanged",t.tl)}},model:{value:t.tl.timestamp[2],callback:function(e){t.$set(t.tl.timestamp,2,e)},expression:"tl.timestamp[2]"}}),n("div",{staticStyle:{"margin-top":"15px"}},[n("v-btn",{attrs:{icon:"",disabled:t.tl.originalText==t.tl.translatedText||t.tl.saving},on:{click:function(e){return t.$emit("stopEditing",t.tl)}}},[t.tl.saving?n("v-progress-circular",{attrs:{indeterminate:"",color:"white"}}):n("v-icon",{attrs:{color:(t.tl.originalText!=t.tl.translatedText?"green":"")+" lighten-1"}},[t._v(" mdi-check ")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.$emit("removeTL",t.tl)}}},[n("v-icon",{attrs:{color:"red lighten-1"}},[t._v("mdi-close")])],1)],1)],1)],1)},G=[],K={name:"TL",props:{tl:{type:Object,required:!0}},methods:Object(T["a"])({},A)},Q=K,Y=n("da13"),tt=n("1800"),et=n("5d23"),nt=n("490a"),it=n("a844"),rt=Object(s["a"])(Q,Z,G,!1,null,null,null),at=rt.exports;q()(rt,{VBtn:J["a"],VIcon:N["a"],VListItem:Y["a"],VListItemAction:tt["a"],VListItemContent:et["a"],VProgressCircular:nt["a"],VTextField:U["a"],VTextarea:it["a"]});var ot={name:"MainUI",components:{Video:$,BottomBar:z,TL:at},data:function(){return{repositioning:!1,saving:!1,videoWidth:.5}},computed:Object(T["a"])(Object(T["a"])({},Object(b["b"])(["player","videoID","tls"])),{},{timestamp:{set:function(t){this.$store.commit("setTimestamp",t)},get:function(){return this.$store.getters.timestamp}},currentTime:{set:function(t){this.$store.commit("setCurrentTime",t)},get:function(){return this.$store.state.currentTime}},videoDuration:{set:function(t){this.$store.commit("setDuration",t)},get:function(){return this.$store.state.videoDuration}},sortedTLs:{get:function(){return this.$store.getters.sortedTLs}}}),watch:{repositioning:function(){document.body.style.setProperty("cursor",this.repositioning?"grabbing":"default","important")},player:function(){var t=this,e=this.player;if(e){var n=setInterval((function(){e.getDuration&&(t.videoDuration=e.getDuration(),clearInterval(n))}),100);window.addEventListener("message",(function(e){try{var n=JSON.parse(e.data);if("infoDelivery"===n.event){try{for(var i=t.binarySearch(t.currentTime),r=t.binarySearch(n.info.currentTime),a=i;a<r;a++)t.splash(t.sortedTLs[a])}catch(o){}n.info.currentTime&&(t.currentTime=n.info.currentTime)}}catch(o){}}))}}},mounted:function(){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.commit("setVideoID",t.$route.params.videoID||t.videoID),t.initLiveTLAPI();case 2:case"end":return e.stop()}}),e)})))()},methods:Object(T["a"])(Object(T["a"])({},A),{},{initLiveTLAPI:function(){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://api.livetl.app/translations/".concat(t.videoID,"/en"));case 3:return e.next=5,e.sent.json();case 5:for(t.tls=e.sent,n=0;n<t.tls.length;n++)t.$store.commit("addAttrTL",{index:n,data:{index:n,timestamp:t.convertToClockTime(t.tls[n].startTimeOffset),saving:!1,originalText:t.tls[n].translatedText}});e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})))()},tlTimeChanged:function(t){t.timestamp=t.timestamp.map((function(t){return parseInt(t)})),t.timestamp[1]<=60&&t.timestamp[2]<=60&&(t.startTimeOffset=60*(60*t.timestamp[0]+t.timestamp[1])+t.timestamp[2])},editTL:function(t){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.player.pauseVideo(),n.next=3,e.$nextTick();case 3:e.scrollIntoView(t);case 4:case"end":return n.stop()}}),n)})))()},addTL:function(){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.currentTime,t.$store.commit("pushTL",{translatedText:"",startTimeOffset:n,index:t.tls.length,timestamp:t.convertToClockTime(n),saving:!1,originalText:""}),t.editTL(t.tls[t.tls.length-1]);case 3:case"end":return e.stop()}}),e)})))()},stopEditing:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.originalText=t.translatedText,n?(t.saving=!0,this.removeIfEmpty(t)||setTimeout((function(){t.saving=!1,e.$forceUpdate()}),1e3)):(this.removeIfEmpty(t),this.$forceUpdate())},removeTL:function(t){this.$store.commit("removeTL",t.index)},removeIfEmpty:function(t){if(!t.translatedText)return this.removeTL(t),!0},dragStarted:function(t,e){var n=this;t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,this.repositioning=!0;var i=function(t){var i=n.videoDuration*(t.clientX-10-window.innerWidth*n.videoWidth)/(window.innerWidth*n.videoWidth-20);e.startTimeOffset=Math.max(Math.min(n.videoDuration,i),0),e.timestamp=n.convertToClockTime(e.startTimeOffset),n.player.seekTo(i)};window.addEventListener("mousemove",i);var r=window.addEventListener("mouseup",(function(){window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",r),n.repositioning=!1}))},scrollIntoView:function(t){var e=document.querySelector("#tl".concat(t.index));e.scrollIntoView({behavior:"smooth",block:"end",inline:"end"}),this.splash(t)},splash:function(t){var e=document.querySelector("#tl".concat(t.index));e.parentElement.classList.remove("splash"),e.offsetHeight,e.parentElement.classList.add("splash")},calcLeft:function(t){return"calc(".concat(t.startTimeOffset/this.videoDuration," * (50% - 20px) + 10px - var(--width) / 2 + 50%)")}})},st=ot,lt=(n("2f8c"),n("7496")),ct=n("8860"),ut=n("f6c4"),dt=Object(s["a"])(st,p,v,!1,null,null,null),mt=dt.exports;q()(dt,{VApp:lt["a"],VList:ct["a"],VListItem:Y["a"],VListItemContent:et["a"],VMain:ut["a"]}),r["a"].use(f["a"]);var ft=[{path:"/:videoID?/",name:"App",component:mt}],pt=new f["a"]({routes:ft}),vt=pt;r["a"].config.productionTip=!1,new r["a"]({store:D,vuetify:m,router:vt,render:function(t){return t(u)}}).$mount("#app")},"94f2":function(t,e,n){"use strict";n("b80d")},b80d:function(t,e,n){}});
//# sourceMappingURL=app.65c1a4a2.js.map